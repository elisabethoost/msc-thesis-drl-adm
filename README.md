## Quick Start (Reproducibility)
this is a test to see if I am working on the state-space branch
**Requirements:**
- Python 3.11 (recommended; other 3.10+ versions may work)
- Git
- (Optional) A C++ compiler for some dependencies (e.g., gym, torch)

**1. Clone the repository:**
```sh
git clone <your-repo-url>
cd <repo-folder>
```

**2. Create and activate a virtual environment:**
- On Windows:
  ```sh
  python -m venv venv
  venv\Scripts\activate
  ```
- On macOS/Linux:
  ```sh
  python3 -m venv venv
  source venv/bin/activate
  ```

**3. Install dependencies:**
```sh
pip install --upgrade pip
pip install -r requirements.txt
```

**4. (Optional) GPU support:**
- If you want to use GPU acceleration, ensure you have the correct CUDA version installed for your PyTorch version. See https://pytorch.org/get-started/locally/ for details.

**Troubleshooting:**
- If you encounter errors related to missing system libraries (e.g., C++ build tools), install them via your OS package manager.
- If you see line ending warnings (LF/CRLF), you can ignore them—they do not affect code execution.
- Do **not** commit your `venv/` directory to git. It is ignored by default in `.gitignore`.

---

## How to use

1. **Scenario Setup**: 
    - Each scenario (e.g., `Example-scenario-1`, `Training-modified/Scenario_01`) provides the input data (aircraft, airports, flights, etc.) in CSV format. The DQN model uses this data to create the initial state space for learning.
  
2. **DQN Training**:
   - The `dqn_train.ipynb` notebook trains the model using the scenario data. The DQN learns by interacting with the environment (airline operations), using the states (aircraft positions, flight schedules) and actions (tail swaps) to maximize rewards (which are based on minutes of delays and cancellations etc.).
   - The trained model is saved in the `/trained_models` folder
   
3. **Inference**:
   - After training, the model can be used to predict the optimal schedule for unseen scenarios using the `dqn_inference.ipynb` notebook. This step evaluates how well the model generalizes to new data.
   - You can compare the results with random actions using `random_inference.ipynb` for baseline performance and to check the correct working of the environment.

4. **Visualization**:
   - The `visualize_scenario.ipynb` notebook provides plots of the different scenarios.


## Key Directories

- **`data/`**: Contains all the input data for the model, including different scenarios like busy airports, proof of concept scenarios, and ROADEF scenarios. Each scenario folder includes CSV files for aircraft, airports, flights, and related information. This folder also contains the training data generated by create_train_data.ipynb
  
- **`notebooks/`**: Jupyter notebooks to run different stages of the model, including:
  - `calc.ipynb`: Random notes/calculations.
  - `create_train_data.ipynb`: Prepares the training data from the raw template scenario.
  - `dqn_train.ipynb`: Trains the DQN model using the prepared data.
  - `dqn_inference.ipynb`: Inference using a trained DQN model.
  - `plot_epsilon.ipynb`: Plots and visualizes the epsilon decay. Just fore testing purposes when choosing the epsilon hyperparameters.
  - `random_inference.ipynb`: Random action inference.
  - `visualize_scenario.ipynb`: Visualizes the scenario.

- **`scripts/`**: Python scripts for data processing, utility functions, and visualizations.
  - `create_data.py`: Handles the generation and manipulation of training data.
  - `utils.py`: Contains helper functions used across the project.
  - `visualizations.py`: Generates visualizations for scenario analysis and model results.

- **`src/`**: Contains the main configuration and environment setup for the DQN model.
  - `config.py`: Defines configuration parameters and environment settings.
  - `environment.py`: Simulates the operational environment where the DQN interacts.

- **`trained_models/`**: Pre-trained DQN models that can be loaded and used for inference.


## Data Files

The project relies on various CSV files, each providing information related to flights, airports, aircraft, and passenger itineraries. Below is an explanation of each CSV file's structure and purpose:

- **`config.csv`**
The configuration file contains parameters related to the scenario:
  - `StartDate/StartTime/EndDate/EndTime`: The recovery period's start and end times.
  - `Cost/min`: Delay costs per minute by cabin class and flight type.
  - `Cancellation Costs`: Penalty for canceling flights, depending on whether the passenger has already begun their journey.
  - `Downgrading Costs`: Penalty costs when passengers are downgraded from a higher to a lower class.
  - `Penalties`: Penalties for not meeting the aircraft location requirements at the end of the recovery period.
  - `Weights (α, β, γ)`: Weights for different cost factors in the objective function.

- **`aircraft.csv`**
This file contains data about the characteristics of each aircraft used during the recovery period. It includes:
  - `Aircraft ID`: Unique identifier for the aircraft.
  - `Model`: The specific model of the aircraft.
  - `Family`: The family or class of the aircraft (e.g., Airbus or Boeing).
  - `Config`: The seat configuration by cabin class (First/Business/Economy).
  - `Dist`: Maximum flight range in hours.
  - `Cost/h`: Hourly operating cost of the aircraft.
  - `TurnRound`: The time required for the aircraft to be prepared for its next flight after landing.
  - `Transit`: Transit time between flights.
  - `Orig`: The starting airport of the aircraft during the recovery period.
  - `Maint`: Details of any scheduled maintenance during the recovery period.

- **`airports.csv`**
This file provides the capacity limits for each airport, indicating how many operations (arrivals and departures) are allowed per one-hour interval based on the time of day. The structure includes:
  - `Airport Code`: IATA code of the airport.
  - `Dep/h`: Maximum departures allowed per hour.
  - `Arr/h`: Maximum arrivals allowed per hour.
  - `StartTime` and **EndTime**: Time windows during which the capacity constraints apply.

- **`flights.csv`**
The flight data file contains information about each flight scheduled during the recovery period. It includes:
  - `Flight`: Unique identifier for the flight.
  - `Orig`: Origin airport.
  - `Dest`: Destination airport.
  - `DepTime`: Scheduled departure time.
  - `ArrTime`: Scheduled arrival time.
  - `PrevFlight`: The identifier of the previous leg in case of multi-leg flights.

- **`dist.csv`**
This file provides the distances (in minutes) between airport pairs, alongside the type of the flight (domestic, continental, or intercontinental). Key fields:
  - `Origin`: IATA code of the origin airport.
  - `Destination`: IATA code of the destination airport.
  - `Dist`: Flight duration in minutes.
  - `Type`: The flight type (Domestic/Continental/Intercontinental).

- **`itineraries.csv`**
This file contains data about the itineraries of passengers, including both outbound and inbound trips. It specifies:
  - `Ident`: Unique identification number for the itinerary.
  - `Type`: Whether the itinerary is outbound (A) or inbound (R).
  - `Price`: The average ticket price for this itinerary.
  - `Count`: The number of passengers on the itinerary.
  - `Flight/DepDate/Cabin`: Details of the flights and cabin class for each leg of the journey.

- **`rotations.csv`**
This file describes the aircraft rotations across different flights during the recovery period. It includes:
  - `Flight`: The flight number operated by the aircraft.
  - `DepDate`: The departure date.
  - `Aircraft`: The ID of the aircraft operating the flight.

- **`position.csv`**
This file lists the number of each type of aircraft that needs to be at each airport by the end of the recovery period. Fields include:
  - `Airport`: IATA code of the airport.
  - `Model/Config/Count`: The required model, configuration, and the number of aircraft to be positioned at that airport.


